<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</head>

<body>

    <div class="container-fluid p-5">
        <div class="row">
            <div class="col-md-4 mx-auto">
                <h3 class="text-center">Web Audio Instrument</h3>
                <hr>
                <form>
                    <div class="form-group">
                        <label for="frequency">Frequency (Hz):</label>
                        <input type="range" min="82.41" max="987.77" value="440" class="form-control-range"
                            id="frequency">
                    </div>
                    <div class="form-group">
                        <label for="waveform">Waveform:</label>
                        <select class="form-control" id="waveform-select">
                            <option value="sine">Sine</option>
                            <option value="square">Square</option>
                            <option value="sawtooth">Sawtooth</option>
                            <option value="triangle">Triangle</option>
                        </select>
                    </div>
                    <div class="form-group text-center">
                        <button type="button" class="btn btn-primary" id="toggleButton"
                            onclick="toggleSound();" value = "OFF">Off</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        const context = new (window.AudioContext || window.webkitAudioContext)();
        const frequency = document.querySelector("#frequency");
        const toggle = document.querySelector("#toggleButton");
        const waveformSelect = document.querySelector("#waveform");
        let oscillator = null;

        frequency.addEventListener("change", function (event) {
            if (oscillator) {
                oscillator.frequency.value = event.target.value;
            }
        });

        // toggle.addEventListener("change", function (event) {
        //     if (document.getElementById("toggleButton").innerHTML == "Off") {
        //         oscillator = context.createOscillator();
        //         oscillator.type = waveformSelect.value;
        //         oscillator.frequency.value = frequency.value;
        //         oscillator.connect(context.destination);
        //         oscillator.start();
        //         document.getElementById("toggleButton").innerHTML = "On";
        //     } else {
        //         oscillator.stop();
        //         oscillator.disconnect();
        //         oscillator = null;
        //         document.getElementById("toggleButton").innerHTML = "Off";
        //     }
        // });

        function toggleSound() {
            var t = document.getElementById("toggleButton");
            if (t.value == "ON") {
                t.value = "OFF";
            }
            else if (t.value == "OFF") {
                t.value = "ON";
            }
        }

        waveformSelect.addEventListener("change", function (event) {
            if (oscillator) {
                oscillator.type = event.target.value;
            }
        });
    </script>

</body>

</html>